

\documentclass[twoside,letterpaper]{sig-alternate}
\usepackage[margin=1in]{geometry}
\usepackage[utf8]{inputenc}
\usepackage{url}
\usepackage{eurosym}
\usepackage{tikz}
%\usepackage{listings}
%\usepackage{graphicx}
%\usepackage{wrapfig}
%\usepackage{caption}
%\usepackage{subcaption}

\usetikzlibrary{cd}
%\usetikzlibrary{shapes,arrows}
%\usetikzlibrary{positioning}
%\usetikzlibrary{calc}

\def\mathcomma{,}
\def\mathperiod{.}

\def\mathcomma{}
\def\mathperiod{}


\title{Identity-based encryption of hello} % first contact
% \subtitle{}
\author{Jeffrey Burdges, Florian Dold, Christian Grothoff}
\date{\today}

\begin{document}
\maketitle

% \section{}

We show that a limited use of identity-base encryption allows us to
improve the security and confidentiality of many modern end-to-end
encrypted messaging protocols,
 while opening a doorway to decentralization. 
% We focus our discussion on the Signal protocol. 

\section{Setting}

Post-Snowden, there has been a explosion in the number and popularity
of end-to-end encrypted messaging applications.\cite{}

Amongst these, Signal has achieved distinction for the impressive
forward-secrecy properties of its Axolotl ratchet\cite{TextSecure}
 coupled with a solidly usable platform.
WhatsApp reached one billion active users around the same time
they finished incorporating the encryption technology from Signal.
\cite{}

For usability, these new protocol have made greater compromises on
their initial key exchanges though.  In Signal, there is an central
key distribution server from which clients obtain a pre-key that
consists of a long-term key and a preliminary ratchet state.
%
Signal actively encourages users to authenticate the fingerprint
provided  by this long-term key, while WhatsApp keeps such features
off by default.

There are subtleties to the pre-key that mitigate the worst attacks,
like by providing pre-keys for all potential contacts
 \cite[\S4.3]{TextSecure}, but
doing do exposes even more meta-data.

Alternatively, one could employ triple Diffie-Hellman inside the
Axolotl ratchet during two initial steps,
 thus sacrificing deniability during those steps,
 and delaying certainty of the fingerprint. 

\section{Goals} 

We propose to adjust the Signal protocol to avoid employing a central
key distribution server all together by using identity-based encryption,
but only in the initial contact request messages.
In doing so, we hope to prevent the authority from replacing pre-keys
quite so easily, and ideally protect meta-data.

We pay a price that content sent by the initiator during
 the contact request could be decrypted by the authority.
A contact request need not allow content though, or
 could carry a warning.

We gain nothing of course if any malefactor can both
 extract the recipient's private key from the authority, and
 manipulate with the user's transport during the initial message.
In particular, we loose if the authority's servers provide
 the transport layer as well. 

One could address this by building a more secure transport layer,
say by adapting Tor hidden services to support an identity-based scheme.
We support this approach because it protects meta-data as well.

We also discuss an orthogonal solution in which we decentralize key
distribution authorities and decoupled from operating the transport.

\section{Key Exchange} 

Along with a long-term fingerprint key,
a Signal pre-key contains the initial elliptic curve point required
by the Axolotl ratchet, meaning
 the first message can operate the ratchet as usual.  
%
For us, this first message use a pairing based crypto system
 such as ... \cite{}.
We derive the initial root key from the identity-base key
exchange and even employ the chain key machinery of Axolotl,
 in case we need to send multiple messages. 

As a rule, pairing friendly curve are large, slow, and relatively
 weak cryptographically.
We should therefore transition the ratchet to a faster higher security
curve $\mathbb{E}$, such as curve25519 \cite{} or
 Ed448-Goldilocks \cite{}, after the initial contact request.
We cannot transform the initiator's key pair from
 our pairing friendly curve system 
into a key pair on $\mathbb{E}$ \cite{??no_homomorphism??}.
As a result, any message sent on this initial chain must include both
 our first Axolotl public key $B \in \mathbb{E}$, along with
 our long-term fingerprint key $F \in \mathbb{E}$.

As usual in Axolotl, we must hold fixed the initiator's public side
 for the identity-base key exchange throughout this initial chain.
In this vein, we need not retain the initiator's private key $u$ for
 the identity-base key exchange, and
 the responder need only run the key exchange once as well.
We do retain the private key $b$ for $B$ until the responder uses it.

As a final tweak to Axolotl, we should incorporate
the long-term fingerprint key by using triple Diffie-Hellman
in the first rounds with $\mathbb{E}$.  
We would however lack confidence in a user's fingerprint until
we have seen it used. 
We could speed this up by using two long-term fingerprint keys,
an initiator one in the pairing system, and
 a responder key for $\mathbb{E}$,
with the fingerprint being the hash of both.

\section{Transport}

... describe Tor hidden services with identity-based keys ...

\section{Decentralization}

Signal could reduce the vulnerability of pre-keys by using
multiple pre-keys distributed to multiple organizations,
 possibly in different legal environment, but
doing so risks exposing user's meta-data to more parties.

In our identity-base scheme, there is no such risk from using
multiple key generation authorities in different jurisdictions.

... describe or cite multi-authority IBE ...

\section{Conclusions} 

...


% \section*{Acknowledgements}
% This work benefits from the financial support of the Brittany Region
% (ARED 9178) and a grant from the Renewable Freedom Foundation.


%\newpage

\bibliographystyle{abbrv}
\bibliography{msg}

\end{document}


\section{}


