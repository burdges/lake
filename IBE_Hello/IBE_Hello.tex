\documentclass[twoside,letterpaper]{sig-alternate}
\usepackage[margin=1in]{geometry}
\usepackage[utf8]{inputenc}
\usepackage{url}
\usepackage{eurosym}
\usepackage{tikz}
%\usepackage{listings}
%\usepackage{graphicx}
%\usepackage{wrapfig}
%\usepackage{caption}
%\usepackage{subcaption}

\usetikzlibrary{cd}
%\usetikzlibrary{shapes,arrows}
%\usetikzlibrary{positioning}
%\usetikzlibrary{calc}

\def\mathcomma{,}
\def\mathperiod{.}

\def\mathcomma{}
\def\mathperiod{}

\title{Identity-based encryption for meta-data protection when first establishing contacts}
% \subtitle{}
\author{Jeffrey Burdges, Florian Dold, Christian Grothoff, Neal Wa{\bf r}field}
\date{\today}

\begin{document}
\maketitle

% \section{}

\begin{abstract}
We argue that a limited use of identity-base encryption would improve
the security and confidentiality of some user-friendly end-to-end
encrypted messaging protocols.
\end{abstract}

\section{Introduction}

% \subsection{Setting}

A secure end-to-end encrypted channel requires that endpoints
authenticate one another, usually by verifing the fingerprint of
one another's public key material.
Assistance in verifying this material therefore becomes an important
feature. % of encryption protocols.

At the same time, the mechanism for obtaining key material tend to
leak meta-data about user's social graph, which proves harmful to 
...~\cite{skynet,??metadatapolution??}.

Available decentralized solutions like the Web-of-Trust~\cite{wot}
leak social graph data since the key signing graph is public and
key lookups use a handfull of key servers.  GNS provides a model
resembling the web-of-trust that leaks less profusely, but offers
no protection against confirmation attacks~\cite{gns}.  
Both these schemes face deployment and adoption challenges.

Instead, there is wave of newer more user-friendly encrypted messaging
applications that distribute public key information using a centralized
trusted authorities, or sometimes trust-on-first-use (TOFU). 

In Signal~\cite{TextSecure} for example, there is a central key server
from which clients obtain a pre-key that consists of a long-term key
and a preliminary Axolotl ratchet state.  
This long term key provides a fingerprint that users could verify
out-of-band, or verbally, for authentication. 

There are two fundemental problems with using centralized key servers
in this way.  
First, users tend not to actually verify fingerprints, so 
key servers could be coerced into substituting a false key.
Signal itself actively encourages users to authenticate fingerprints,
but proprietary efforts tend not to show fingerprints by default.
Second, the authority learns who resolved which names.

Signal's Axolotl ratchet has impressive forward-secrecy properties
that strengthen any protocol parts that depend upon TOFU, and
reduces the sheer diversity of attacks on systems like PGP.
Of course, forward-secrecy cannot replace authentication.
Yet, Sgnal provides deniability for example.

\smallskip
% \subsection{Goals}

We propose that, systems like Signal that already rely on an authority,
should avoid exposing meta data to the authority by using
identity-based encryption (IBE) when first establishing a contact.
In this first message, we share the long-term fingerprint key and
ratchet state, which must themselves be real non-identity-based key
material. 

In essence, we employ IBE only for a weak form of authentication, 
while full authentication still requires that users verify fingerprints
TOFU style.
In doing so, we prevent meta data leakage to the authority, and reduce
its attack surface for manipulating pre-keys.  

Our scheme remains vulnerable to an attacker who can both
 extract the recipient's private key from the authority, and
 attack the transport during the initial exchange.  
In particular, we loose if the authority's servers provide the transport
layer as well, which costs us our hard won anoymity anyways. 

We need two features to address this :

First, we need an anonymity preserving transport layer where recipients
are determined using an identity.  We could for example adapt Tor to
support an identity-based naming scheme for hidden services.  

Second, we should decentralize our IBE scheme's private key issuing
authority by allowing contact initiators to select amongst numerous
authorites.

Alone neither appears sufficent, but taken together they provide 
considerably stronger protections. 


\section{Key Exchange}

Along with a long-term fingerprint key,
a Signal pre-key contains the initial elliptic curve point required
by the Axolotl ratchet, meaning
 the first message can operate the ratchet as usual.
%
For us, this first message use a pairing based crypto system
 such as ... \cite{}.
We derive the initial root key from the identity-base key
exchange and even employ the chain key machinery of Axolotl,
 in case we need to send multiple messages.

As a rule, pairing friendly curve are large, slow, and relatively
 weak cryptographically.
We should therefore transition the ratchet to a faster higher security
curve $\mathbb{E}$, such as curve25519 \cite{} or
 Ed448-Goldilocks \cite{}, after the initial contact request.
We cannot transform the initiator's key pair from
 our pairing friendly curve system
into a key pair on $\mathbb{E}$ \cite{??no_homomorphism??}.
As a result, any message sent on this initial chain must include both
 our first Axolotl public key $B \in \mathbb{E}$, along with
 our long-term fingerprint key $F \in \mathbb{E}$.

As usual in Axolotl, we must hold fixed the initiator's public side
 for the identity-base key exchange throughout this initial chain.
In this vein, we need not retain the initiator's private key $u$ for
 the identity-base key exchange, and
 the responder need only run the key exchange once as well.
We do retain the private key $b$ for $B$ until the responder uses it.

As a final tweak to Axolotl, we should incorporate
the long-term fingerprint key by using triple Diffie-Hellman
in the first rounds with $\mathbb{E}$.
We would however lack confidence in a user's fingerprint until
we have seen it used.
We could speed this up by using two long-term fingerprint keys,
an initiator one in the pairing system, and
 a responder key for $\mathbb{E}$,
with the fingerprint being the hash of both.

\section{Security}


In using IBE, we pay a price that our initiatial message during
 the contact request could be decrypted by the authority.
A contact request need not allow content though, adding at least one round trip,
or could carry a warning.



In this vein, there remain an Unknown Key Share attack on Signal that
even verfying fingerprints cannot address~\cite[\S4.2]{TextSecure}.
At least one proposal for fixing the Unknown Key Share attack
modifies the pre-keys to leak not only all new contacts, but
all currently known possible contacts~\cite[\S4.3]{TextSecure}. 
% FIXME: Read \S4.2 and \S4.3 in TextSecure if the above makes no sense.
%
Alternatively, one could employ triple Diffie-Hellman inside the
Axolotl ratchet during two initial steps,
 thus sacrificing deniability during those steps,
 and delaying certainty of the fingerprint. 


\section{Anonymity in IBE}


Sakaiâ€“Kasahara scheme (SAKKE)



\section{Transport}

... describe Tor hidden services with identity-based keys ...

\section{Decentralization}

Signal could reduce the vulnerability of pre-keys by using
multiple pre-keys distributed to multiple organizations,
 possibly in different legal environment, but
doing so risks exposing user's meta-data to more parties.

In our identity-base scheme, there is no such risk from using
multiple key generation authorities in different jurisdictions.

... describe or cite multi-authority IBE ...

\section{Conclusions}

...


% \section*{Acknowledgements}
% This work benefits from the financial support of the Brittany Region
% (ARED 9178) and a grant from the Renewable Freedom Foundation.


%\newpage

\bibliographystyle{abbrv}
\bibliography{msg}

\end{document}


\section{}
